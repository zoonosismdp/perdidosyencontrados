<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MGP - Animales</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/perdidosyencontrados.css">

    <style>
        .login-form-container {
            max-width: 500px;
            margin: 30px auto; 
            padding: 30px;
            border: 1px solid #e0e0e0;
            border-radius: 0.5rem;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
            background-color: #fff;
            padding-left: 15px; 
            padding-right: 15px;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f9fa; 
        }
        
        @media (max-width: 576px) {
            .login-form-container {
                width: 95%; 
                margin-top: 20px;
                padding: 15px; 
            }
        }
        
        #estadoAnimal::placeholder {
            font-style: italic;
            color: #888; 
            opacity: 1; 
        }
        
    </style>
</head>

<body>
    <header>
        <div class='holder'>
            <img src="img/logo.png" alt="Perdidos y Encontrados" width="100">
            <h1>Sitio oficial de animales perdidos y encontrados</h1>
        </div>
    </header>

    <nav>
        <div class="holder">
            <ul>
                <li><a href="index.html">Inicio</a></li>
                <li><a href="publicados.html">Animales Publicados</a></li>
                <li><a class="activo" href="denunciasperdidos.html">Denuncia Animal Perdido</a></li>
                <li><a href="denunciaencontrados.html">Denuncia Animal Encontrado</a></li>
                <li><a href="about.html">Sobre el proyecto</a></li>
            </ul>
        </div>
    </nav>

    <section class="publicados_texto">
        <h2>Formulario de Denuncia de Animal Perdido </h2>
    </section>

    <div class="container-fluid">
        <div class="login-form-container">
            <form id="perdidosForm">

                <h3 class="mt-4 mb-3">Datos del Animal Perdido</h3>

                <div class="mb-3">
                    <label for="tipoAnimal" class="form-label">Tipo:</label>
                    <select class="form-control" id="tipoAnimal" name="tipo">
                        <option value="canino">Canino</option>
                        <option value="felino">Felino</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="nombreAnimal" class="form-label">Nombre del animal:</label>
                    <input type="text" class="form-control" id="nombreAnimal" name="nombre" placeholder="Ej.Toby" required>
                </div>

                <div class="mb-3">
                    <label for="fechaExtravio" class="form-label">Fecha de extravío:</label>
                    <input type="date" class="form-control" id="fechaExtravio" name="fecha_extravio"
                        placeholder="dd/mm/aaaa" required>
                </div>

                <div class="mb-3">
                    <label for="lugarExtravio" class="form-label">Lugar de extravío:</label>
                    <input type="text" class="form-control" id="lugarExtravio" name="lugar_extravio"
                        placeholder="Ingrese el lugar de extravío" required>
                </div>

                <div class="mb-3">
                    <label for="edadAnimal" class="form-label">Edad:</label>
                    <input type="text" class="form-control" id="edadAnimal" name="edad" placeholder="Ej: 3 años, adulto, estimada" required>
                </div>

                <div class="mb-3">
                    <label for="tamanoAnimal" class="form-label">Tamaño:</label>
                    <select class="form-control" id="tamanoAnimal" name="tamaño">
                        <option value="chico">Chico</option>
                        <option value="mediano">Mediano</option>
                        <option value="grande">Grande</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="comportamientoAnimal" class="form-label">Comportamiento:</label>
                    <select class="form-control" id="comportamientoAnimal" name="comportamiento">
                        <option value="amigable">Amigable</option>
                        <option value="tieneMiedo">Tiene miedo</option>
                        <option value="muerde">Muerde</option>
                        <option value="esAgresivo">Es agresivo</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="otrasCaracteristicas" class="form-label">Otras características:</label>
                    <select class="form-control" id="otrasCaracteristicas" name="caracteristicas"
                        onchange="toggleOtraCaracteristica(this)">
                        <option value="manchas">Manchas</option>
                        <option value="microchip">Tiene microchip</option>
                        <option value="informacionMedica">Información médica</option>
                        <option value="otra">Otra</option>
                    </select>
                    <input type="text" class="form-control mt-2" id="otraCaracteristica"
                        placeholder="Escriba la otra característica" name="otra_caracteristica_texto" style="display:none;">
                </div>

                <script>
                    function toggleOtraCaracteristica(select) {
                        const otraCaracteristica = document.getElementById('otraCaracteristica');
                        if (select.value === 'otra') {
                            otraCaracteristica.style.display = 'block';
                            select.setAttribute('data-name', select.name);
                            select.name = '';
                            otraCaracteristica.name = 'caracteristicas'; 
                        } else {
                            otraCaracteristica.style.display = 'none';
                            otraCaracteristica.value = '';
                            otraCaracteristica.name = ''; 
                            if(select.hasAttribute('data-name')) {
                                select.name = select.getAttribute('data-name');
                            } else {
                                select.name = 'caracteristicas'; 
                            }
                        }
                    }
                </script>

                <div class="mb-3">
                    <label for="fotoFrente" class="form-label">Foto frente (máx. 1 MB, formato PNG, JPG, BMP):</label>
                    <input type="file" class="form-control" id="fotoFrente" name="foto_frente" accept=".png, .jpg, .bmp"
                        max-size="1048576">
                </div>

                <div class="mb-3">
                    <label for="fotoPerfil" class="form-label">Foto perfil (máx. 1 MB, formato PNG, JPG, BMP):</label>
                    <input type="file" class="form-control" id="fotoPerfil" name="foto_perfil" accept=".png, .jpg, .bmp"
                        max-size="1048576">
                </div>

                <div class="mb-3">
                    <label for="estadoAnimal" class="form-label">Estado al momento de extraviarse:</label>
                    <input type="text" class="form-control" id="estadoAnimal" name="estado_inicial"
                        placeholder="Ej: Llevaba collar rojo" required>
                </div>

                <h3 class="mt-4 mb-3">Datos de Contacto</h3>

                <div class="mb-3">
                    <label for="telefono" class="form-label">Teléfono / WhatsApp:</label>
                    <input type="tel" class="form-control" id="telefono" name="tel_contacto"
                        placeholder="Ingrese su número de teléfono" required>
                </div>

                <div class="mb-3">
                    <label for="nombreDuenio" class="form-label">Nombre del dueño responsable:</label>
                    <input type="text" class="form-control" id="nombreDuenio" name="nombre_contacto"
                        placeholder="Ingrese el nombre del dueño" required>
                </div>

                <div class="mb-3">
                    <label for="correoElectronico" class="form-label">Correo electrónico:</label>
                    <input type="email" class="form-control" id="correoElectronico" name="email_contacto"
                        placeholder="Ingrese su correo electrónico" required>
                </div>

                <div class="mb-3">
                    <label for="redSocial" class="form-label">Red social publicada:</label>
                    <input type="text" class="form-control" id="redSocial" name="redSocial_contacto"
                        placeholder="Ej: Facebook, Instagram" required>
                </div>

                <div class="mb-3">
                    <button type="submit" class="btn btn-success">Enviar Denuncia</button>
                </div>

            </form>
        </div>
    </div>
    <footer>
        <div class="foot">
            <p>Diseñado por Di Pierro Sebastian</p>
        </div>
    </footer>


    <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="successModalLabel">Datos registrados</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Los mismos serán sujetos a aprobación para su publicación.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Aceptar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const fechaExtravioInput = document.getElementById('fechaExtravio');
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0'); 
            const day = String(today.getDate()).padStart(2, '0');
            
            const maxDate = `${year}-${month}-${day}`;
            
            fechaExtravioInput.setAttribute('max', maxDate);
        });


        document.getElementById('perdidosForm').addEventListener('submit', function(e) {
            e.preventDefault(); 

            const form = e.target;
            const scriptURL = 'https://script.google.com/macros/s/AKfycbygLkp3l0q4apa5b7s9Kz88HDHrw6YgnJFyr2hbNgfDAtaEJVbmhwe5kKHREsCpn796zQ/exec';
            const formData = new FormData(form);

            formData.delete('foto_frente');
            formData.delete('foto_perfil');

            const submitButton = form.querySelector('button[type="submit"]');
            submitButton.disabled = true;
            submitButton.textContent = 'Enviando...';

            fetch(scriptURL, { method: 'POST', body: formData })
                .then(response => {
                    if (response.ok) {
                        const successModal = new bootstrap.Modal(document.getElementById('successModal'));
                        successModal.show();

                        form.reset();
                    } else {
                        alert('Ocurrió un error al registrar los datos. Inténtelo de nuevo.');
                    }
                })
                .catch(error => {
                    console.error('Error!', error.message);
                    alert('Ocurrió un error de conexión. Por favor, revise su red.');
                })
                .finally(() => {
                    submitButton.disabled = false;
                    submitButton.textContent = 'Enviar Denuncia';
                });
        });
    </script>
</body>

</html>